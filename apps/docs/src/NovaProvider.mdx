# NovaProvider

The **NovaProvider** is the centerpiece of the `@tuwaio/nova-transactions` library. It's a comprehensive, all-in-one solution that orchestrates the entire transaction tracking UI experience in your dApp. üéØ

## What is NovaProvider?

`NovaProvider` is a powerful React component that combines all transaction tracking UI features into a single, easy-to-use instance. It acts as the central coordinator for:

-   üçû **Smart toast notifications** with live updates.
-   üì± **An interactive modal** for detailed transaction progress tracking.
-   üíº **A wallet info modal** for displaying the connected account and transaction history.
-   üåê **An internationalization (i18n) context** for all UI elements.
-   üé® **Flexible customization** of appearance and functionality.

Think of it as your dApp's transaction UI control center: include it **once** in your root layout, and it handles rendering all necessary modals and notifications globally for your application. **It does not wrap your `children`**.

```tsx
// In your root layout (e.g., AppLayout.tsx)
function AppLayout({ children }) {
  return (
    <div>
      {children}

      {/* NovaProvider renders alongside your app, not as a wrapper */}
      <NovaProvider {...props} />
    </div>
  );
}
````

-----

## Setup and Usage

To use the provider, place it in a high-level layout component and pass it the required props from your Pulsar store and `wagmi`.

```tsx
// src/providers/index.tsx
'use client';

import {usePulsar} from '@/store/pulsar';
import {NovaProvider} from '@tuwaio/nova-transactions';
import {useAccount, WagmiProvider} from 'wagmi';
import {QueryClient, QueryClientProvider} from '@tanstack/react-query';
import {PulsarInitializer} from '@/components/PulsarInitializer';
import {wagmiConfig, chains} from '@/configs'; // Your app's configs
import {TransactionAdapter} from '@tuwaio/pulsar-core';
import {evmAdapter} from '@tuwaio/pulsar-evm';

// Import required CSS
import '@tuwaio/nova-core/dist/index.css';
import '@tuwaio/nova-transactions/dist/index.css';
import 'react-toastify/dist/ReactToastify.css';

const queryClient = new QueryClient();

export function Providers({ children }: { children: React.ReactNode }) {
  // 1. Get state and actions from your Pulsar store hook
  const {
    transactionsPool,
    initialTx,
    handleTransaction,
    closeTxTrackedModal,
  } = usePulsar();
  
  // 2. Get live wallet data from wagmi
  const { address, chain } = useAccount();

  return (
    <WagmiProvider config={wagmiConfig}>
      <QueryClientProvider client={queryClient}>
        <PulsarInitializer />
          
        {children}

        {/* 3. Render NovaProvider as a self-contained UI manager */}
        <NovaProvider
          // --- Props from Pulsar Store ---
          transactionsPool={transactionsPool}
          initialTx={initialTx}
          handleTransaction={handleTransaction}
          closeTxTrackedModal={closeTxTrackedModal}
          
          // --- Props from Wallet Connector (e.g., wagmi) ---
          connectedWalletAddress={address}
          connectedAdapterType={chain?.id ? TransactionAdapter.EVM : undefined} // Example for EVM
          
          // --- Static Configuration ---
          // Adapter or adapters array, similar like using for store
          adapter={evmAdapter(wagmiConfig, chains)}
        />
      </QueryClientProvider>
    </WagmiProvider>
  );
}
```

-----

## Customization

### Feature Flags

Enable or disable the main UI elements using the `features` prop. All are enabled by default.

```tsx
<NovaProvider
  // ...other props
  features={{
    toasts: true,
    walletInfoModal: false, // Example: disable the wallet info modal
    trackingTxModal: true,
  }}
/>
```

### Component Overrides

The `customization` prop allows you to replace any internal component with your own implementation.

```tsx
import { MyCustomBadge } from './MyCustomBadge';

<NovaProvider
  // ...other props
  customization={{
    toast: {
        // You can override any component inside the toast
        components: {
            StatusBadge: ({ tx }) => <MyCustomBadge status={tx.status} />
        }
    },
  }}
/>
```

### Toast Container Customization

`NovaProvider` uses `react-toastify` under the hood. You can pass any props for its `ToastContainer` directly to `NovaProvider` to control its behavior.

```tsx
<NovaProvider
  // ...other props
  // --- Props for react-toastify's ToastContainer ---
  position="top-right"
  limit={5}
  newestOnTop
  theme="dark"
/>
```

### Internationalization (i18n)

Easily translate all text by passing a `labels` object.

```tsx
const germanLabels = {
  statuses: {
    pending: 'In Bearbeitung...',
    success: 'Erfolgreich!',
    // ...
  },
};

<NovaProvider
  // ...other props
  labels={germanLabels}
/>
```

-----

## Props Reference

| Prop                     | Type                               | Required | Description                                                              |
| ------------------------ | ---------------------------------- | :------: | ------------------------------------------------------------------------ |
| `adapter`                | `TxAdapter or TxAdapter[]`         |    ‚úÖ    | Adapter or array of configured adapters similar to your Pulsar store.                 |
| `transactionsPool`       | `TransactionPool`                  |    ‚úÖ    | The current transaction pool from your Pulsar store.                     |
| `handleTransaction`      | `Function`                         |    ‚úÖ    | The handler function from your store to initiate transactions.           |
| `closeTxTrackedModal`    | `(txKey?: string) => void`         |    ‚úÖ    | A function from your store to close the tracking modal.                  |
| `connectedWalletAddress` | `string`                           |    -     | The address of the currently connected wallet.                           |
| `connectedAdapterType`   | `TransactionAdapter`               |    -     | The adapter type of the currently connected wallet (e.g., TransactionAdapter.EVM).        |
| `initialTx`              | `InitialTransaction`               |    -     | The initial transaction object from your store.                          |
| `labels`                 | `Partial<TuwaLabels>`              |    -     | An object to override the default text labels for i18n.                  |
| `features`               | `object`                           |    -     | An object to enable or disable UI features like toasts or modals.        |
| `customization`          | `object`                           |    -     | An object for deep styling and component replacement.                    |

> **Note**: All props for `ToastContainer` from `react-toastify` are also supported and can be passed directly to `NovaProvider`.
