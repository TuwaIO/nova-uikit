# NovaProvider

The **NovaProvider** is the centerpiece of the `@tuwaio/nova-transactions` library. It's a comprehensive, all-in-one solution that orchestrates the entire transaction tracking UI experience in your dApp. üéØ

## What is NovaProvider?

`NovaProvider` is a powerful React component that combines all transaction tracking UI features into a single, easy-to-use instance. It acts as the central coordinator for:

-   üçû **Smart toast notifications** with live updates.
-   üì± **Interactive modals** for detailed transaction progress tracking.
-   üíº **Displaying wallet information** and transaction history.
-   üåê **Providing internationalization (i18n)** context for all UI elements.
-   üé® **Enabling flexible customization** of appearance and functionality.

Think of it as your dApp's transaction UI control center: include it **once** in your root layout, and it handles rendering all necessary modals and notifications globally for your application.

## Key Advantages

### üöÄ All-in-One Component, Zero-Clutter Solution

Instead of importing and managing multiple modals and toast containers in your app's layout, you get everything with a single component. This significantly simplifies integration and keeps your component tree clean.

```tsx
// In your root layout (e.g., AppLayout.tsx)
function AppLayout({ children }) {
  return (
    <div>
      {children}

      {/* NovaProvider renders alongside your app, not as a wrapper */}
      <NovaProvider {...props} />
    </div>
  );
}
````

### ‚ö°Ô∏è Smart Features Out of the Box

  - **Automatic UI Reactions**: Listens to your transaction store and automatically triggers toasts and modals.
  - **Multi-tracker Support**: Works with standard Ethereum transactions, as well as Gelato and Safe.
  - **Optimized Performance**: The component is designed to minimize re-renders.
  - **Graceful Error Handling**: Provides beautiful and clear error messages with retry options.

### üé® Advanced Customization

Every aspect of the UI, from toasts to modals, can be configured via the `features`, `customization`, and `labels` props to perfectly match your design system.

-----

## Core Features

`NovaProvider` orchestrates three key UI elements that work together seamlessly.

### üçû Toast Notifications

Smart, non-intrusive notifications that appear automatically based on transaction state changes. They are fully customizable and stack elegantly if multiple transactions are active.

### üì± Tracking Modal

A detailed modal that provides real-time visualization of transaction progress. It is triggered when a new transaction is initiated with `withTrackedModal: true`.

### üíº Wallet Info Modal

A comprehensive view of the user's wallet, including transaction history. This modal is controlled internally but can be opened from other components, like the toast notifications.

-----

## Basic Usage

To use the provider, place it in a high-level layout component and pass it the required props from your Pulsar store and `wagmi`.

```tsx
// In your main providers file (e.g., src/providers/index.tsx)
import { NovaProvider } from '@tuwaio/nova-transactions';
import { usePulsarStore } from '../hooks/txTrackingHooks';
import { wagmiConfig, appChains } from '../configs/wagmiConfig';
import { useAccount, WagmiProvider } from 'wagmi';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';

// 1. Create a new QueryClient instance
const queryClient = new QueryClient();

export function Providers({ children }) {
  // 2. Get state and actions from your Pulsar store
  const transactionsPool = usePulsarStore((state) => state.transactionsPool);
  const initialTx = usePulsarStore((state) => state.initialTx);
  const closeTxTrackedModal = usePulsarStore(
    (state) => state.closeTxTrackedModal,
  );
  const handleTransaction = usePulsarStore(
    (state) => state.handleTransaction,
  );
  const actions = usePulsarStore((state) => state.actions);

  // 3. Get wallet info from Wagmi
  const { address, chain } = useAccount();

  return (
    // 4. Wrap everything in WagmiProvider
    <WagmiProvider config={wagmiConfig}>
      <QueryClientProvider client={queryClient}>
        {/* Your other providers and app content */}
        {children}

        {/* 5. Render NovaProvider as a standalone component */}
        <NovaProvider
          // --- Required props from your store ---
          transactionsPool={transactionsPool}
          handleTransaction={handleTransaction}
          appChains={appChains}
          config={wagmiConfig}
          closeTxTrackedModal={closeTxTrackedModal}
          // --- Optional props ---
          initialTx={initialTx}
          walletAddress={address}
          chain={chain}
          actions={actions}
        />
      </QueryClientProvider>
    </WagmiProvider>
  );
}
```

-----

## Advanced Customization

### üö© Feature Flags

You can easily enable or disable the main UI elements using the `features` prop. By default, all are enabled.

```tsx
<NovaProvider
  // ...other props
  features={{
    toasts: true, // Enable/disable toast notifications
    walletInfoModal: false, // Example: disable the wallet modal
    trackingTxModal: true, // Enable/disable transaction tracking modal
  }}
/>
```

### üé® Deep Styling (Customization)

The `customization` prop allows you to pass objects for deep styling and component replacement for each UI element.

```tsx
<NovaProvider
  // ...other props
  customization={{
    toast: {
      className: 'custom-toast-styles',
    },
    trackingTxModal: {
      className: 'custom-tracking-modal',
    },
  }}
/>
```

### ‚öôÔ∏è Toast Container Customization

`NovaProvider` uses `react-toastify` under the hood. You can pass any props for its `ToastContainer` directly to `NovaProvider`.

```tsx
<NovaProvider
  // ...other props
  // --- Props for react-toastify ---
  position="top-right"
  limit={5}
  newestOnTop
  theme="dark"
/>
```

### üåê Internationalization (i18n)

You can easily translate all text by passing a `labels` object.

```tsx
const myLabels = {
  transactionModal: {
    pending: 'Ausstehend...',
    success: 'Erfolgreich!',
    // ...
  },
};

<NovaProvider
  // ...other props
  labels={myLabels}
/>
```

-----

## Props Reference

### Core Props

| Prop                  | Type                                   | Required | Description                                             |
| --------------------- | -------------------------------------- | :------: | ------------------------------------------------------- |
| `transactionsPool`    | `TransactionPool<TR, T>`               |    ‚úÖ    | The current transaction pool from your state store.     |
| `handleTransaction`   | `Function`                             |    ‚úÖ    | The handler function from your store to initiate txs.   |
| `appChains`           | `Chain[]`                              |    ‚úÖ    | An array of supported networks (from `viem/chains`).    |
| `config`              | `Config`                               |    ‚úÖ    | The Wagmi configuration object.                         |
| `closeTxTrackedModal` | `() => void`                           |    ‚úÖ    | A function from your store to close the tracking modal. |

### Optional Props

| Prop            | Type                 | Description                                                  |
| --------------- | -------------------- | ------------------------------------------------------------ |
| `walletAddress` | `Address`            | The address of the currently connected wallet.               |
| `chain`         | `Chain`              | The currently active chain.                                  |
| `initialTx`     | `InitialTransaction` | The initial transaction from your store to show in the modal. |
| `actions`       | `ActionRegistry`     | An object of actions for retry logic.                        |

### Customization Props

| Prop            | Type                                                               | Description                                                          |
| --------------- | ------------------------------------------------------------------ | -------------------------------------------------------------------- |
| `labels`        | `Partial<TuwaLabels>`                                              | An object to override the default text labels.                       |
| `features`      | `{ toasts?: boolean; walletInfoModal?: boolean; ... }`             | An object to enable/disable UI features.                             |
| `customization` | `{ toast?: ToastTransactionCustomization; ... }`                   | An object for deep styling and behavior customization. |

> **Note**: All props for `ToastContainer` from `react-toastify` are also supported and can be passed directly to `NovaProvider`.

-----

## Best Practices

### 1\. Single Instance at the Root

Use only **one** `NovaProvider` per application. It's designed to be a singleton and should be placed at a high level in your component tree, like `_app.tsx` or a root `Layout.tsx`, so it can render above all other content. **It should not wrap your page content.**

### 2\. Memoize Props

To prevent unnecessary re-renders, wrap complex objects like `customization` or `actions` in `useMemo` if they are defined within a component that re-renders often.

-----

## Summary

`NovaProvider` is a powerful, flexible, and beautiful solution for Web3 transaction UX. By centralizing control of modals and toasts into a single component, it streamlines development and provides your users with a world-class, consistent transaction experience. **Start with the basic setup and customize as needed\!** üöÄ