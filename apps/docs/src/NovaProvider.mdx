# NovaProvider

The **NovaProvider** is the centerpiece of the `@tuwaio/nova-transactions` library. It's a comprehensive, all-in-one solution that orchestrates the entire transaction tracking UI experience in your dApp. üéØ

## What is NovaProvider?

`NovaProvider` is a powerful React context provider that combines all transaction tracking UI features into a single, easy-to-use component. It acts as the central coordinator for:

-   üçû **Smart toast notifications** with live updates.
-   üì± **Interactive modals** for detailed transaction progress tracking.
-   üíº **Displaying wallet information** and transaction history.
-   üåê **Providing internationalization (i18n)** context for all nested components.
-   üé® **Enabling flexible customization** of appearance and functionality.

Think of it as your dApp's transaction UI control center: wrap your application with it once, and get a complete, production-ready Web3 transaction UX.

## Key Advantages

### üöÄ All-in-One Provider, Zero-Clutter Solution

Instead of importing and managing multiple modals and toast containers in your app's layout, you get everything with a single provider. This significantly simplifies integration and keeps your component tree clean.

```tsx
// All transaction UI is handled by this single provider
<NovaProvider {...props}>
  <MyApp />
</NovaProvider>
````

### ‚ö°Ô∏è Smart Features Out of the Box

  - **Automatic UI Reactions**: Listens to your transaction store and automatically triggers toasts and modals.
  - **Multi-tracker Support**: Works with standard Ethereum transactions, as well as Gelato and Safe.
  - **Intelligent Updates**: The component only re-renders its children when necessary, optimizing performance.
  - **Graceful Error Handling**: Provides beautiful and clear error messages with retry options.

### üé® Advanced Customization

Every aspect of the UI, from toasts to modals, can be configured via the `features`, `customization`, and `labels` props to perfectly match your design system.

-----

## Core Features

`NovaProvider` orchestrates three key UI elements that work together seamlessly.

### üçû Toast Notifications

Smart, non-intrusive notifications that appear automatically based on transaction state changes. They are fully customizable and stack elegantly if multiple transactions are active.

### üì± Tracking Modal

A detailed modal that provides real-time visualization of transaction progress. It is triggered when a new transaction is initiated and configured with `withTrackedModal: true`.

### üíº Wallet Info Modal

A comprehensive view of the user's wallet, including transaction history. This modal is controlled internally but can be opened from other components, like the toast notifications.

-----

## Basic Usage

To get the provider working, you need to connect it to your application's state. The example below uses a Zustand store, which is the recommended approach for managing transaction state with Pulsar.

```tsx
import { NovaProvider } from '@tuwaio/nova-transactions';
import { useTxTrackingStore } from '../store'; // Your Zustand store
import { wagmiConfig, chains } from '../config'; // Your configurations
import { useAccount } from 'wagmi';

function AppLayout({ children }) {
  // 1. Get state and actions from your tracking store
  const transactionsPool = useTxTrackingStore((state) => state.transactionsPool);
  const initialTx = useTxTrackingStore((state) => state.initialTx);
  const closeTxTrackedModal = useTxTrackingStore(
    (state) => state.closeTxTrackedModal,
  );
  const handleTransaction = useTxTrackingStore(
    (state) => state.handleTransaction,
  );
  const actions = useTxTrackingStore((state) => state.actions);

  // 2. Get wallet info from Wagmi
  const { address, chain } = useAccount();

  return (
    // 3. Wrap your app and pass the props
    <NovaProvider
      // --- Required props from your store ---
      transactionsPool={transactionsPool}
      handleTransaction={handleTransaction}
      appChains={chains}
      config={wagmiConfig}
      closeTxTrackedModal={closeTxTrackedModal}
      // --- Optional props ---
      initialTx={initialTx}
      walletAddress={address}
      chain={chain}
      actions={actions}
    >
      {children}
    </NovaProvider>
  );
}
```

-----

## Advanced Customization

### üö© Feature Flags

You can easily enable or disable the main UI elements using the `features` prop. By default, all are enabled.

```tsx
<NovaProvider
  // ...other props
  features={{
    toasts: true, // Enable/disable toast notifications
    walletInfoModal: true, // Enable/disable wallet modal
    trackingTxModal: true, // Enable/disable transaction tracking modal
  }}
/>
```

### üé® Deep Styling (Customization)

The `customization` prop allows you to pass objects for deep styling and component replacement for each UI element.

```tsx
<NovaProvider
  // ...other props
  customization={{
    toast: {
      className: 'custom-toast-styles',
    },
    walletInfoModal: {
      className: 'custom-wallet-modal',
    },
    trackingTxModal: {
      className: 'custom-tracking-modal',
    },
  }}
/>
```

### ‚öôÔ∏è Toast Container Customization

`NovaProvider` uses `react-toastify` under the hood. You can pass any props for `ToastContainer` directly to `NovaProvider`.

```tsx
<NovaProvider
  // ...other props
  // --- Props for react-toastify ---
  position="top-right"
  limit={5}
  newestOnTop
  theme="dark"
/>
```

-----

## Internationalization (i18n)

You can easily translate all text to any language by passing a `labels` object. This context is available to all nested Nova components.

```tsx
const myLabels = {
  transaction: {
    pending: 'Erwartung...',
    success: 'Die Transaktion ist erfolgreich!',
    // ...
  },
};

<NovaProvider
  // ...other props
  labels={myLabels}
/>
```

-----

## Props Reference

### Core Props

| Prop                  | Type                                   | Required | Description                                             |
| --------------------- | -------------------------------------- | :------: | ------------------------------------------------------- |
| `transactionsPool`    | `TransactionPool<TR, T>`               |    ‚úÖ    | The current transaction pool from your state store.     |
| `handleTransaction`   | `Function`                             |    ‚úÖ    | The handler function from your store to initiate txs.   |
| `appChains`           | `Chain[]`                              |    ‚úÖ    | An array of supported networks (from `viem/chains`).    |
| `config`              | `Config`                               |    ‚úÖ    | The Wagmi configuration object.                         |
| `closeTxTrackedModal` | `() => void`                           |    ‚úÖ    | A function from your store to close the tracking modal. |

### Optional Props

| Prop            | Type                 | Description                                                  |
| --------------- | -------------------- | ------------------------------------------------------------ |
| `walletAddress` | `Address`            | The address of the currently connected wallet.               |
| `chain`         | `Chain`              | The currently active chain.                                  |
| `initialTx`     | `InitialTransaction` | The initial transaction from your store to show in the modal. |
| `actions`       | `ActionRegistry`     | An object of actions for retry logic.                        |

### Customization Props

| Prop            | Type                                                               | Description                                                          |
| --------------- | ------------------------------------------------------------------ | -------------------------------------------------------------------- |
| `labels`        | `Partial<TuwaLabels>`                                              | An object to override the default text labels.                       |
| `features`      | `{ toasts?: boolean; walletInfoModal?: boolean; ... }`             | An object to enable/disable UI features.                             |
| `customization` | `{ toast?: ToastTransactionCustomization; ... }`                   | An object for deep styling and behavior customization. |

> **Note**: All props for `ToastContainer` from `react-toastify` are also supported and can be passed directly to `NovaProvider`.

-----

## Best Practices

### 1\. Single Instance at the Root

Use only **one** `NovaProvider` per application. It's designed to be a singleton and should be placed in a high-level component, like `_app.tsx` or a root `Layout.tsx`, wrapping your entire page content.

### 2\. Memoize Props

To prevent unnecessary re-renders, wrap complex objects like `customization` or `actions` in `useMemo` if they are defined within a component that re-renders often.

-----

## Summary

`NovaProvider` is a powerful, flexible, and beautiful solution for Web3 transaction UX. By centralizing control of modals and toasts, it streamlines development and provides your users with a world-class, consistent transaction experience. **Start with the basic setup and customize as needed\!** üöÄ