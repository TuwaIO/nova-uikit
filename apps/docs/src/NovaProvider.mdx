# NovaProvider

The **NovaProvider** is the centerpiece of the `@tuwaio/nova-transactions` library. It's a comprehensive, all-in-one solution that orchestrates the entire transaction tracking UI experience in your dApp. üéØ

## What is NovaProvider?

`NovaProvider` is a powerful React component that combines all transaction tracking UI features into a single, easy-to-use instance. It acts as the central coordinator for:

-   üçû **Smart toast notifications** with live updates.
-   üì± **An interactive modal** for detailed transaction progress tracking.
-   üíº **A wallet info modal** for displaying the connected account and transaction history.
-   üåê **An internationalization (i18n) context** for all UI elements.
-   üé® **Flexible customization** of appearance and functionality.

Think of it as your dApp's transaction UI control center: include it **once** in your root layout, and it handles rendering all necessary modals and notifications globally for your application. **It does not wrap your `children`**.

-----

## Setup and Usage

To use the provider, you first need to create the Pulsar store using the EVM adapter (in example) or any other and a custom hook, as shown in `txTrackingHooks.tsx`. This setup allows you to pass the store's state and functions to the NovaProvider. Then, you can use the `NovaProvider` as a standalone component in your root layout.

```tsx
// src/hooks/txTrackingHooks.tsx
'use client';

import { createBoundedUseStore, createPulsarStore } from '@tuwaio/pulsar-core';
import { evmAdapter } from '@tuwaio/pulsar-evm';

import { appChains, config } from '@/configs/wagmiConfig';

const storageName = 'transactions-tracking-storage';

export enum TxType {
  example = 'example',
}

type ExampleTx = Transaction & {
  type: TxType.example;
  payload: {
    value: number;
  };
};

export type TransactionUnion = ExampleTx;

export const usePulsarStore = createBoundedUseStore(
  createPulsarStore<TransactionUnion>({
    name: storageName,
    adapter: evmAdapter(config, appChains),
  }),
);
```

```tsx
// src/providers/NovaProvider.tsx
import { NovaProvider as NP } from '@tuwaio/nova-transactions/providers';
import { TransactionAdapter } from '@tuwaio/pulsar-core';
import { useInitializeTransactionsPool } from '@tuwaio/pulsar-react';
import { useAccount } from 'wagmi';

import { usePulsarStore } from '@/hooks/txTrackingHooks';

export function NovaProvider() {
  const transactionsPool = usePulsarStore((state) => state.transactionsPool);
  const initialTx = usePulsarStore((state) => state.initialTx);
  const closeTxTrackedModal = usePulsarStore((state) => state.closeTxTrackedModal);
  const handleTransaction = usePulsarStore((state) => state.handleTransaction);
  const initializeTransactionsPool = usePulsarStore((state) => state.initializeTransactionsPool);
  const getAdapter = usePulsarStore((state) => state.getAdapter);

  useInitializeTransactionsPool({ initializeTransactionsPool });

  const { address } = useAccount();

  return (
    <NP
      transactionsPool={transactionsPool}
      initialTx={initialTx}
      closeTxTrackedModal={closeTxTrackedModal}
      handleTransaction={handleTransaction}
      connectedWalletAddress={address}
      connectedAdapterType={TransactionAdapter.EVM}
      adapter={getAdapter()}
    />
  );
}

```

```tsx
// src/providers/index.tsx
'use client';

import { RainbowKitProvider } from '@rainbow-me/rainbowkit';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import { ReactNode } from 'react';
import { WagmiProvider } from 'wagmi';

import { config } from '@/configs/wagmiConfig';

import { NovaProvider } from './NovaProvider';

const queryClient = new QueryClient();

export function Providers({ children }: { children: ReactNode }) {
  return (
    <WagmiProvider config={config}>
      <QueryClientProvider client={queryClient}>
        <RainbowKitProvider>
          <NovaProvider />
          {children}
        </RainbowKitProvider>
      </QueryClientProvider>
    </WagmiProvider>
  );
}
```

-----

## Customization

### Feature Flags

Enable or disable the main UI elements using the `features` prop. All are enabled by default.

```tsx
<NovaProvider
  // ...other props
  features={{
    toasts: true,
    walletInfoModal: false, // Example: disable the wallet info modal
    trackingTxModal: true,
  }}
/>
```

### Component Overrides

The `customization` prop allows you to replace any internal component with your own implementation.

```tsx
import { MyCustomBadge } from './MyCustomBadge';

<NovaProvider
  // ...other props
  customization={{
    toast: {
        // You can override any component inside the toast
        components: {
            StatusBadge: ({ tx }) => <MyCustomBadge status={tx.status} />
        }
    },
  }}
/>
```

### Toast Container Customization

`NovaProvider` uses `react-toastify` under the hood. You can pass any props for its `ToastContainer` directly to `NovaProvider` to control its behavior.

```tsx
<NovaProvider
  // ...other props
  // --- Props for react-toastify's ToastContainer ---
  position="top-right"
  limit={5}
  newestOnTop
  theme="dark"
/>
```

### Internationalization (i18n)

Easily translate all text by passing a `labels` object.

```tsx
const germanLabels = {
  statuses: {
    pending: 'In Bearbeitung...',
    success: 'Erfolgreich!',
    // ...
  },
};

<NovaProvider
  // ...other props
  labels={germanLabels}
/>
```

-----

## Props Reference

| Prop                     | Type                               | Required | Description                                                              |
| ------------------------ | ---------------------------------- | :------: | ------------------------------------------------------------------------ |
| `adapter`                | `TxAdapter or TxAdapter[]`         |    ‚úÖ    | Adapter or array of configured adapters similar to your Pulsar store.                 |
| `transactionsPool`       | `TransactionPool`                  |    ‚úÖ    | The current transaction pool from your Pulsar store.                     |
| `handleTransaction`      | `Function`                         |    ‚úÖ    | The handler function from your store to initiate transactions.           |
| `closeTxTrackedModal`    | `(txKey?: string) => void`         |    ‚úÖ    | A function from your store to close the tracking modal.                  |
| `connectedWalletAddress` | `string`                           |    -     | The address of the currently connected wallet.                           |
| `connectedAdapterType`   | `TransactionAdapter`               |    -     | The adapter type of the currently connected wallet (e.g., TransactionAdapter.EVM).        |
| `initialTx`              | `InitialTransaction`               |    -     | The initial transaction object from your store.                          |
| `labels`                 | `Partial<TuwaLabels>`              |    -     | An object to override the default text labels for i18n.                  |
| `features`               | `object`                           |    -     | An object to enable or disable UI features like toasts or modals.        |
| `customization`          | `object`                           |    -     | An object for deep styling and component replacement.                    |

> **Note**: All props for `ToastContainer` from `react-toastify` are also supported and can be passed directly to `NovaProvider`.
